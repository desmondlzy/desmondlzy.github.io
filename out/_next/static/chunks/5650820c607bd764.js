(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,40104,e=>{"use strict";var t=e.i(86143),s=e.i(22828),l=e.i(36299),a=e.i(78613),r=e.i(67784);let i=(0,r.default)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),n=(0,r.default)("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),o=(0,r.default)("grid-3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),d=(0,r.default)("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),c=(0,r.default)("square-x",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),x=(0,r.default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);var m=e.i(54053),h=e.i(55995);let p=(0,r.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),y=(0,r.default)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);function g(e="item"){return`${e}-${Date.now()}-${Math.random().toString(36).slice(2,9)}`}var u=e.i(54679);function b({onClose:e,onCreatePiece:l,editingPiece:a}){let[r,i]=(0,s.useState)(a?.type||m.PieceType.UNION),[n,o]=(0,s.useState)(a?.shape||[[1,1],[1,1]]),d=e=>{let t=Array(n[0].length).fill(0);o(s=>"top"===e?[t,...s]:[...s,t])},c=e=>{o(t=>t.map(t=>"left"===e?[0,...t]:[...t,0]))},x=e=>{n.length<=1||o(t=>"top"===e?t.slice(1):t.slice(0,-1))},b=e=>{n[0].length<=1||o(t=>t.map(t=>"left"===e?t.slice(1):t.slice(0,-1)))},v=e=>{i(e)},f=n.every(e=>e.every(e=>0===e));return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:a?"Edit Piece Shape":"Create New Piece"}),(0,t.jsx)("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,t.jsx)(h.X,{className:"w-5 h-5"})})]}),(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Piece Type"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)("button",{onClick:()=>v(m.PieceType.UNION),className:`px-4 py-3 border-2 rounded transition-all ${r===m.PieceType.UNION?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[(0,t.jsx)("div",{className:"font-medium",style:{color:u.PIECE_COLORS[m.PieceType.UNION]},children:"UNION (OR)"}),(0,t.jsx)("div",{className:"text-xs text-gray-600",children:"Blue - Adds coverage"})]}),(0,t.jsxs)("button",{onClick:()=>v(m.PieceType.XOR),className:`px-4 py-3 border-2 rounded transition-all ${r===m.PieceType.XOR?"border-red-500 bg-red-50":"border-gray-200 hover:border-gray-300"}`,children:[(0,t.jsx)("div",{className:"font-medium",style:{color:u.PIECE_COLORS[m.PieceType.XOR]},children:"XOR (Toggle)"}),(0,t.jsx)("div",{className:"text-xs text-gray-600",children:"Red - Toggles coverage"})]}),(0,t.jsxs)("button",{onClick:()=>v(m.PieceType.INTERSECT),className:`px-4 py-3 border-2 rounded transition-all ${r===m.PieceType.INTERSECT?"border-amber-500 bg-amber-50":"border-gray-200 hover:border-gray-300"}`,children:[(0,t.jsx)("div",{className:"font-medium",style:{color:u.PIECE_COLORS[m.PieceType.INTERSECT]},children:"INTERSECT (AND)"}),(0,t.jsx)("div",{className:"text-xs text-gray-600",children:"Amber - Intersection only"})]}),(0,t.jsxs)("button",{onClick:()=>v(m.PieceType.BLOCKER),className:`px-4 py-3 border-2 rounded transition-all ${r===m.PieceType.BLOCKER?"border-gray-500 bg-gray-50":"border-gray-200 hover:border-gray-300"}`,children:[(0,t.jsx)("div",{className:"font-medium",style:{color:u.PIECE_COLORS[m.PieceType.BLOCKER]},children:"BLOCKER"}),(0,t.jsx)("div",{className:"text-xs text-gray-600",children:"Gray - Blocks overlaps"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Shape Editor"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("button",{onClick:()=>d("top"),className:"px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded transition-colors flex items-center gap-1",children:[(0,t.jsx)(p,{className:"w-3 h-3"})," Row Top"]}),(0,t.jsxs)("button",{onClick:()=>d("bottom"),className:"px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded transition-colors flex items-center gap-1",children:[(0,t.jsx)(p,{className:"w-3 h-3"})," Row Bottom"]}),(0,t.jsxs)("button",{onClick:()=>x("top"),disabled:n.length<=1,className:"px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 disabled:bg-gray-50 disabled:text-gray-400 rounded transition-colors flex items-center gap-1",children:[(0,t.jsx)(y,{className:"w-3 h-3"})," Top"]}),(0,t.jsxs)("button",{onClick:()=>x("bottom"),disabled:n.length<=1,className:"px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 disabled:bg-gray-50 disabled:text-gray-400 rounded transition-colors flex items-center gap-1",children:[(0,t.jsx)(y,{className:"w-3 h-3"})," Bottom"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("button",{onClick:()=>c("left"),className:"px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded transition-colors flex items-center gap-1",children:[(0,t.jsx)(p,{className:"w-3 h-3"})," Col Left"]}),(0,t.jsxs)("button",{onClick:()=>c("right"),className:"px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded transition-colors flex items-center gap-1",children:[(0,t.jsx)(p,{className:"w-3 h-3"})," Col Right"]}),(0,t.jsxs)("button",{onClick:()=>b("left"),disabled:n[0].length<=1,className:"px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 disabled:bg-gray-50 disabled:text-gray-400 rounded transition-colors flex items-center gap-1",children:[(0,t.jsx)(y,{className:"w-3 h-3"})," Left"]}),(0,t.jsxs)("button",{onClick:()=>b("right"),disabled:n[0].length<=1,className:"px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 disabled:bg-gray-50 disabled:text-gray-400 rounded transition-colors flex items-center gap-1",children:[(0,t.jsx)(y,{className:"w-3 h-3"})," Right"]})]}),(0,t.jsxs)("div",{className:"inline-block p-4 bg-gray-50 rounded border border-gray-200",children:[(0,t.jsx)("div",{className:"grid gap-1",style:{gridTemplateColumns:`repeat(${n[0].length}, 40px)`},children:n.map((e,s)=>e.map((e,l)=>(0,t.jsx)("button",{onClick:()=>{o(e=>e.map((e,t)=>t===s?e.map((e,t)=>t===l?+(1!==e):e):e))},className:"w-10 h-10 rounded border-2 transition-all",style:{backgroundColor:1===e?(0,u.getPieceColor)(r):"white",borderColor:1===e?(0,u.getPieceColor)(r):"#d1d5db"}},`${s}-${l}`)))}),(0,t.jsxs)("div",{className:"mt-2 text-xs text-gray-500 text-center",children:["Click cells to toggle. Size: ",n[0].length,"×",n.length]})]})]})]})]}),(0,t.jsxs)("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex items-center justify-between",children:[(0,t.jsx)("button",{onClick:e,className:"px-4 py-2 text-gray-700 hover:bg-gray-200 rounded transition-colors",children:"Cancel"}),(0,t.jsx)("button",{onClick:()=>{l({id:a?.id||g("piece"),type:r,shape:n,position:a?.position||{x:0,y:0}}),e()},disabled:f,className:"px-6 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed text-white rounded transition-colors",children:a?"Save Changes":"Create Piece"})]})]})})}let v=(0,r.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),f=(0,r.default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),j=(0,r.default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);function N({x:e,y:l,pieceId:a,currentType:r,onClose:i,onChangeType:n,onEditShape:o,onDelete:d,onDuplicate:c}){let x=(0,s.useRef)(null);return(0,s.useEffect)(()=>{let e=e=>{x.current&&!x.current.contains(e.target)&&i()},t=e=>{"Escape"===e.key&&i()};return document.addEventListener("mousedown",e),document.addEventListener("keydown",t),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",t)}},[i]),(0,t.jsxs)("div",{ref:x,className:"fixed bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50 min-w-48",style:{left:`${e}px`,top:`${l}px`},children:[(0,t.jsxs)("div",{className:"px-2 py-1",children:[(0,t.jsx)("div",{className:"text-xs font-medium text-gray-500 px-2 py-1",children:"Change Type"}),(0,t.jsxs)("button",{onClick:()=>{n(m.PieceType.UNION),i()},disabled:r===m.PieceType.UNION,className:"w-full px-3 py-2 text-left text-sm hover:bg-blue-50 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,t.jsx)("span",{className:"text-blue-500 font-medium",children:"UNION"}),r===m.PieceType.UNION&&(0,t.jsx)("span",{className:"ml-2 text-xs text-gray-500",children:"(current)"})]}),(0,t.jsxs)("button",{onClick:()=>{n(m.PieceType.XOR),i()},disabled:r===m.PieceType.XOR,className:"w-full px-3 py-2 text-left text-sm hover:bg-red-50 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,t.jsx)("span",{className:"text-red-500 font-medium",children:"XOR"}),r===m.PieceType.XOR&&(0,t.jsx)("span",{className:"ml-2 text-xs text-gray-500",children:"(current)"})]}),(0,t.jsxs)("button",{onClick:()=>{n(m.PieceType.INTERSECT),i()},disabled:r===m.PieceType.INTERSECT,className:"w-full px-3 py-2 text-left text-sm hover:bg-amber-50 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,t.jsx)("span",{className:"text-amber-500 font-medium",children:"INTERSECT"}),r===m.PieceType.INTERSECT&&(0,t.jsx)("span",{className:"ml-2 text-xs text-gray-500",children:"(current)"})]}),(0,t.jsxs)("button",{onClick:()=>{n(m.PieceType.BLOCKER),i()},disabled:r===m.PieceType.BLOCKER,className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-100 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,t.jsx)("span",{className:"text-gray-600 font-medium",children:"BLOCKER"}),r===m.PieceType.BLOCKER&&(0,t.jsx)("span",{className:"ml-2 text-xs text-gray-500",children:"(current)"})]})]}),(0,t.jsx)("div",{className:"border-t border-gray-200 my-1"}),(0,t.jsxs)("button",{onClick:()=>{o(),i()},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 rounded transition-colors flex items-center gap-2",children:[(0,t.jsx)(f,{className:"w-4 h-4"}),"Edit Shape"]}),(0,t.jsxs)("button",{onClick:()=>{c(),i()},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 rounded transition-colors flex items-center gap-2",children:[(0,t.jsx)(j,{className:"w-4 h-4"}),"Duplicate"]}),(0,t.jsx)("div",{className:"border-t border-gray-200 my-1"}),(0,t.jsxs)("button",{onClick:()=>{d(),i()},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 rounded transition-colors flex items-center gap-2",children:[(0,t.jsx)(v,{className:"w-4 h-4"}),"Delete"]})]})}function w(e){let t=[],s=[],l=0,a=0,r=0,i=0;for(let n of(e.grid.forEach(e=>{for(let t of e)"M"===t&&l++,("A"===t||"a"===t)&&a++,("D"===t||"d"===t)&&r++,"I"===t&&i++}),0===l&&t.push({type:"missing-main",message:"Level must have at least one Main (M) cell"}),0===i&&t.push({type:"missing-inventory",message:"Level must have at least one Inventory (I) cell"}),0===a&&s.push({type:"no-allowed",message:"No Allowed (A) cells defined. Players may not understand win conditions."}),0===r&&s.push({type:"no-disallowed",message:"No Disallowed (D) cells defined. This level may not have clear win conditions."}),[...e.mainSymbols.replace(/[\n\r]/g,"")].length!==l&&t.push({type:"symbol-mismatch",message:`Main symbols count (${[...e.mainSymbols].length}) doesn't match M cells (${l})`}),[...e.allowedSymbols.replace(/[\n\r]/g,"")].length!==a&&t.push({type:"symbol-mismatch",message:`Allowed symbols count (${[...e.allowedSymbols].length}) doesn't match A cells (${a})`}),[...e.disallowedSymbols.replace(/[\n\r]/g,"")].length!==r&&t.push({type:"symbol-mismatch",message:`Disallowed symbols count (${[...e.disallowedSymbols].length}) doesn't match D cells (${r})`}),e.initialPieces)){let s=n.shape[0]?.length||0,l=n.shape.length;(n.position.x<0||n.position.y<0||n.position.x+s>e.width||n.position.y+l>e.height)&&t.push({type:"piece-outside-grid",message:`Piece "${n.id}" is positioned outside the grid bounds`,itemId:n.id})}for(let s of e.initialPieces)s.shape.every(e=>e.every(e=>0===e))&&t.push({type:"empty-shape",message:`Piece "${s.id}" has an empty shape`,itemId:s.id});return 0===e.initialPieces.length&&s.push({type:"no-pieces",message:"No pieces defined. Level may not be playable."}),{valid:0===t.length,errors:t,warnings:s}}let k=(0,r.default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var C=e.i(98952);let S=(0,r.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),E=(0,r.default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);function T({level:e,onClose:l}){var a;let[r,i]=(0,s.useState)(e.id),[n,o]=(0,s.useState)(null),[d,c]=(0,s.useState)(""),[x,m]=(0,s.useState)(!1),[p,y]=(0,s.useState)(!1),g=async()=>{try{await navigator.clipboard.writeText(d),y(!0),setTimeout(()=>y(!1),2e3)}catch(e){console.error("Failed to copy:",e)}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[(0,t.jsxs)("div",{className:"border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Validate & Export Level"}),(0,t.jsx)("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,t.jsx)(h.X,{className:"w-5 h-5"})})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Level Number/ID"}),(0,t.jsx)("input",{type:"text",value:r,onChange:e=>i(e.target.value),placeholder:"e.g., 2, new, tutorial",className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,t.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:'This will be used for the filename (e.g., "2.ts") and constant name (e.g., "LEVEL_2")'})]}),(0,t.jsx)("div",{children:(0,t.jsx)("button",{onClick:()=>{o(w(e))},className:"px-4 py-2 bg-amber-500 hover:bg-amber-600 text-white rounded transition-colors",children:"Validate Level"})}),n&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:`p-4 rounded border-2 ${n.valid?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:(0,t.jsx)("div",{className:"flex items-center gap-2",children:n.valid?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S,{className:"w-5 h-5 text-green-600"}),(0,t.jsx)("span",{className:"font-medium text-green-900",children:"Validation passed! Ready to export."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k,{className:"w-5 h-5 text-red-600"}),(0,t.jsx)("span",{className:"font-medium text-red-900",children:"Validation failed. Fix errors before exporting."})]})})}),n.errors.length>0&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-red-900",children:"Errors:"}),(0,t.jsx)("ul",{className:"space-y-1",children:n.errors.map((e,s)=>(0,t.jsxs)("li",{className:"flex items-start gap-2 text-sm text-red-700",children:[(0,t.jsx)(k,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),(0,t.jsxs)("span",{children:[e.message,e.itemId&&(0,t.jsxs)("span",{className:"text-xs text-red-600 ml-1",children:["(",e.itemId,")"]})]})]},s))})]}),n.warnings.length>0&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-amber-900",children:"Warnings:"}),(0,t.jsx)("ul",{className:"space-y-1",children:n.warnings.map((e,s)=>(0,t.jsxs)("li",{className:"flex items-start gap-2 text-sm text-amber-700",children:[(0,t.jsx)(C.AlertTriangle,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),(0,t.jsx)("span",{children:e.message})]},s))})]})]}),x&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:"Generated TypeScript Code"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("button",{onClick:g,className:"px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded transition-colors flex items-center gap-1",children:[(0,t.jsx)(j,{className:"w-4 h-4"}),p?"Copied!":"Copy"]}),(0,t.jsxs)("button",{onClick:()=>{let e=new Blob([d],{type:"text/typescript"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download=`${r||"new"}.ts`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t)},className:"px-3 py-1.5 text-sm bg-blue-100 hover:bg-blue-200 text-blue-700 rounded transition-colors flex items-center gap-1",children:[(0,t.jsx)(E,{className:"w-4 h-4"}),"Download"]})]})]}),(0,t.jsx)("pre",{className:"p-4 bg-gray-900 text-gray-100 rounded overflow-x-auto text-xs font-mono max-h-64 overflow-y-auto",children:d}),(0,t.jsxs)("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Next Steps:"}),(0,t.jsxs)("ol",{className:"text-sm text-blue-800 space-y-1 list-decimal list-inside",children:[(0,t.jsxs)("li",{children:["Save the code above to"," ",(0,t.jsxs)("code",{className:"px-1 py-0.5 bg-blue-100 rounded text-xs",children:["/app/levels/",r||"new",".ts"]})]}),(0,t.jsxs)("li",{children:["Add the import to"," ",(0,t.jsx)("code",{className:"px-1 py-0.5 bg-blue-100 rounded text-xs",children:"/app/levels/index.ts"})]}),(0,t.jsx)("li",{children:"Add the level to the LEVELS array with a descriptive name"}),(0,t.jsxs)("li",{children:["Run ",(0,t.jsx)("code",{className:"px-1 py-0.5 bg-blue-100 rounded text-xs",children:"pnpm build"})," ","to verify"]}),(0,t.jsx)("li",{children:"Test the level in the game!"})]})]}),(0,t.jsxs)("details",{className:"text-sm",children:[(0,t.jsx)("summary",{className:"cursor-pointer font-medium text-gray-700 hover:text-gray-900",children:"Show index.ts code snippet"}),(0,t.jsx)("pre",{className:"mt-2 p-3 bg-gray-100 rounded text-xs font-mono overflow-x-auto",children:(a=r||"new",`// Add to /app/levels/index.ts:

import { LEVEL_${a} } from './${a}';

// In the LEVELS array, add:
{
  id: '${a}',
  name: 'Level ${a}', // Change this to a descriptive name
  level: LEVEL_${a}
}`)})]})]})]}),(0,t.jsxs)("div",{className:"border-t border-gray-200 px-6 py-4 flex items-center justify-between bg-gray-50",children:[(0,t.jsx)("button",{onClick:l,className:"px-4 py-2 text-gray-700 hover:bg-gray-200 rounded transition-colors",children:"Close"}),(0,t.jsx)("button",{onClick:()=>{let t,s;o(w(e));let l=r||"new";c((t=e.grid.map(e=>`        "${e}"`).join(",\n"),s=e.initialPieces.map(e=>`        {
            id: '${e.id}',
            type: PieceType.${e.type},
            position: { x: ${e.position.x}, y: ${e.position.y} },
            shape: ${JSON.stringify(e.shape)}
        }`).join(",\n"),`import { Level, PieceType } from '../types';

export default <Level>{
    id: '${e.id||`level-${l}`}',
    name: '${e.name||`Level ${l}`}',
    width: ${e.width},
    height: ${e.height},
    coveredAllowedSymbolLimit: 0,  // default to 0, adjust as needed
    grid: [
${t}
    ],
    mainSymbols: "${e.mainSymbols.replace(/\n/g,"")}",
    allowedSymbols: "${e.allowedSymbols.replace(/\n/g,"")}",
    disallowedSymbols: "${e.disallowedSymbols.replace(/\n/g,"")}",
    initialPieces: [
${s}
    ]
};
`)),m(!0)},disabled:!r,className:"px-6 py-2 bg-indigo-500 hover:bg-indigo-600 disabled:bg-gray-300 disabled:cursor-not-allowed text-white rounded transition-colors",children:"Generate Code"})]})]})})}var L=e.i(63641);function P({onClose:e,onLoad:s}){return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-hidden flex flex-col",children:[(0,t.jsxs)("div",{className:"border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Load Existing Level"}),(0,t.jsx)("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,t.jsx)(h.X,{className:"w-5 h-5"})})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Select a level to load as a template. You can then modify it and export as a new level."}),(0,t.jsx)("div",{className:"space-y-2",children:L.LEVELS.map(l=>(0,t.jsxs)("button",{onClick:()=>{s(l.level),e()},className:"w-full px-4 py-3 bg-gray-50 hover:bg-gray-100 border border-gray-200 rounded text-left transition-colors",children:[(0,t.jsx)("div",{className:"font-medium text-gray-900",children:l.level.name}),(0,t.jsxs)("div",{className:"text-xs text-gray-600",children:[l.level.width,"×",l.level.height," grid,",l.level.initialPieces.length," ","pieces"]})]},l.id))})]}),(0,t.jsx)("div",{className:"border-t border-gray-200 px-6 py-4 bg-gray-50",children:(0,t.jsx)("button",{onClick:e,className:"w-full px-4 py-2 text-gray-700 hover:bg-gray-200 rounded transition-colors",children:"Cancel"})})]})})}var $=e.i(63948);function R(){let e,r,m,h,p,y,[u,v]=(0,s.useState)("level-editor-"+Date.now()),[f,j]=(0,s.useState)("Unnamed Level"),[w,k]=(0,s.useState)(7),[C,S]=(0,s.useState)(7),[E,L]=(0,s.useState)(Array(15).fill(".".repeat(20))),[R,M]=(0,s.useState)(""),[I,O]=(0,s.useState)(""),[A,D]=(0,s.useState)(""),[B,V]=(0,s.useState)([]),[z,U]=(0,s.useState)("M"),[X,K]=(0,s.useState)(!1),[q,_]=(0,s.useState)(!1),[H,Y]=(0,s.useState)(!1),[G,F]=(0,s.useState)(!1),[W,J]=(0,s.useState)(null),[Q,Z]=(0,s.useState)(null),[ee,et]=(0,s.useState)(null),[es,el]=(0,s.useState)(null),[ea,er]=(0,s.useState)({x:0,y:0}),[ei,en]=(0,s.useState)({x:0,y:0}),eo=(0,s.useRef)(null);(0,s.useEffect)(()=>{L(e=>{let t=Array(C).fill(".".repeat(w));return e.forEach((e,s)=>{if(s<C){let l=e.slice(0,w).padEnd(w,".");t[s]=l}}),t})},[w,C]);let ed=(e,t)=>{if(e<0||e>=w||t<0||t>=C)return;let s=[...E],l=s[t].split("");l[e]=z,s[t]=l.join(""),L(s)},ec=()=>{K(!1)},ex=e=>{if(!es||!eo.current)return;let t=eo.current.getBoundingClientRect(),s=e.clientX-t.left,l=e.clientY-t.top;en({x:s-ea.x,y:l-ea.y})},em=()=>{if(!es)return;let e={x:Math.round(ei.x/40),y:Math.round(ei.y/40)};V(B.map(t=>t.id===es?{...t,position:e}:t)),el(null)};return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(l.default,{href:"/",className:"text-gray-600 hover:text-gray-900",children:(0,t.jsx)(a.ArrowLeft,{size:20})}),(0,t.jsx)("h1",{className:"text-xl font-semibold",children:"Level Editor"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>F(!0),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded",children:"Load Level"}),(0,t.jsx)("button",{onClick:()=>{let e=0,t=0,s=0;E.forEach(l=>{for(let a of l)"M"===a&&e++,("A"===a||"a"===a)&&t++,("D"===a||"d"===a)&&s++});let l=R.replace(/[\n\r]/g,""),a=I.replace(/[\n\r]/g,""),r=A.replace(/[\n\r]/g,""),i=[];0===e&&i.push("No Main (M) cells defined"),[...l].length!==e&&i.push(`Main symbols count (${[...l].length}) doesn't match M cells (${e})`),[...a].length!==t&&i.push(`Allowed symbols count (${[...a].length}) doesn't match A/a cells (${t})`),[...r].length!==s&&i.push(`Disallowed symbols count (${[...r].length}) doesn't match D/d cells (${s})`),i.length>0?et(i.join("\\n")):et("✓ Level is valid!")},className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded",children:"Validate"}),(0,t.jsx)("button",{onClick:()=>{Y(!0)},className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded",children:"Export"})]})]})}),(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsxs)("div",{className:"w-64 bg-white border-r border-gray-200 p-4",children:[(0,t.jsx)("h2",{className:"font-semibold mb-4",children:"Brushes"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2",children:[{type:".",label:"Empty",icon:i,color:"bg-white"},{type:"#",label:"Blocked",icon:n,color:"bg-gray-600 text-white"},{type:"M",label:"Main",icon:o,color:"bg-blue-400 text-white"},{type:"A",label:"Allowed",icon:d,color:"bg-green-400 text-white"},{type:"a",label:"B-Allowed",icon:d,color:"bg-green-600 text-white"},{type:"D",label:"Disallowed",icon:c,color:"bg-red-400 text-white"},{type:"d",label:"B-Disallowed",icon:c,color:"bg-red-600 text-white"},{type:"I",label:"Inventory",icon:x,color:"bg-purple-400 text-white"}].map(e=>{let s=e.icon;return(0,t.jsxs)("button",{onClick:()=>U(e.type),className:`p-3 rounded border-2 transition ${z===e.type?"border-blue-500 "+e.color:"border-gray-200 hover:border-gray-300 "+e.color}`,children:[(0,t.jsx)(s,{size:20,className:"mx-auto mb-1"}),(0,t.jsx)("div",{className:"text-xs text-center",children:e.label})]},e.type)})}),(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)("h2",{className:"font-semibold mb-2",children:"Grid Size"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm",children:"Width"}),(0,t.jsx)("input",{type:"number",value:w,onChange:e=>k(Number(e.target.value)),className:"w-full px-2 py-1 border rounded",min:5,max:50})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm",children:"Height"}),(0,t.jsx)("input",{type:"number",value:C,onChange:e=>S(Number(e.target.value)),className:"w-full px-2 py-1 border rounded",min:5,max:50})]})]}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)("button",{onClick:()=>{confirm("Are you sure you want to clear the entire grid?")&&L(Array(C).fill(".".repeat(w)))},className:"w-full px-4 py-2 bg-red-50 hover:bg-red-100 text-red-600 border border-red-200 rounded transition-colors text-sm font-medium",children:"Clear Grid"})})]}),(0,t.jsxs)("div",{className:"mt-6 space-y-2",children:[(0,t.jsx)("button",{onClick:()=>{J(null),_(!0)},className:"w-full px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded",children:"Add Piece"}),(0,t.jsx)("button",{onClick:()=>{confirm("Are you sure you want to clear all pieces?")&&V([])},className:"w-full px-4 py-2 bg-red-50 hover:bg-red-100 text-red-600 border border-red-200 rounded transition-colors text-sm font-medium",children:"Clear Pieces"})]})]}),(0,t.jsxs)("div",{className:"flex-1 p-8 overflow-auto",children:[(0,t.jsxs)("div",{ref:eo,className:"relative bg-white border-2 border-gray-300 select-none",style:{width:40*w,height:40*C,cursor:X?"crosshair":"default",boxSizing:"content-box"},onPointerDown:e=>{if(!eo.current)return;let t=eo.current.getBoundingClientRect(),s=Math.floor((e.clientX-t.left)/40),l=Math.floor((e.clientY-t.top)/40);K(!0),ed(s,l)},onPointerMove:e=>{if(!X||!eo.current)return;let t=eo.current.getBoundingClientRect();ed(Math.floor((e.clientX-t.left)/40),Math.floor((e.clientY-t.top)/40))},onPointerUp:ec,onPointerLeave:ec,children:[(e=0,r=0,m=0,h=[...R.replace(/[\n\r]/g,"")],p=[...I.replace(/[\n\r]/g,"")],y=[...A.replace(/[\n\r]/g,"")],E.map((s,l)=>s.split("").map((s,a)=>{let i="transparent",n="none",o="";return"M"===s?(i="#93c5fd",o=h[e]||"",e++):"A"===s||"a"===s?(i="#86efac",o=p[r]||"",r++,"a"===s&&(n="repeating-linear-gradient(45deg, rgba(0,0,0,0.1) 0, rgba(0,0,0,0.1) 2px, transparent 2px, transparent 10px)")):"D"===s||"d"===s?(i="#fca5a5",o=y[m]||"",m++,"d"===s&&(n="repeating-linear-gradient(45deg, rgba(0,0,0,0.1) 0, rgba(0,0,0,0.1) 2px, transparent 2px, transparent 10px)")):"I"===s?i="#d8b4fe":"#"===s&&(i="#9ca3af"),(0,t.jsx)("div",{style:{position:"absolute",left:40*a,top:40*l,width:40,height:40,backgroundColor:i,backgroundImage:n,border:"1px solid rgba(0,0,0,0.05)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",fontWeight:"bold",color:"#1f2937"},children:o},`${l}-${a}`)}))),B.map(e=>{let s=e.id===es,l=s?ei:{x:40*e.position.x,y:40*e.position.y};return(0,t.jsx)("div",{style:{position:"absolute",left:l.x,top:l.y,cursor:"move",zIndex:s?1e3:10},onPointerDown:t=>((e,t)=>{if(e.stopPropagation(),!eo.current)return;let s=eo.current.getBoundingClientRect(),l=e.clientX-s.left,a=e.clientY-s.top,r=40*t.position.x,i=40*t.position.y;el(t.id),er({x:l-r,y:a-i}),en({x:r,y:i})})(t,e),onPointerMove:ex,onPointerUp:em,onContextMenu:t=>{t.preventDefault(),Z({x:t.clientX,y:t.clientY,pieceId:e.id,currentType:e.type})},children:(0,t.jsx)($.PieceRenderer,{piece:{...e,position:{x:0,y:0}},cellSize:40})},e.id)})]}),ee&&(0,t.jsx)("div",{className:`mt-4 p-4 rounded ${ee.startsWith("✓")?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:(0,t.jsx)("pre",{className:"whitespace-pre-wrap",children:ee})})]}),(0,t.jsxs)("div",{className:"w-80 bg-white border-l border-gray-200 p-4",children:[(0,t.jsx)("h2",{className:"font-semibold mb-4",children:"Level Info"}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Level ID"}),(0,t.jsx)("input",{type:"text",value:u,onChange:e=>v(e.target.value),className:"w-full px-3 py-2 border rounded text-sm",placeholder:"Enter level ID"})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Level Name"}),(0,t.jsx)("input",{type:"text",value:f,onChange:e=>j(e.target.value),className:"w-full px-3 py-2 border rounded text-sm",placeholder:"Enter level name"})]}),(0,t.jsx)("h2",{className:"font-semibold mb-4",children:"Symbol Streams"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Main Symbols (M cells)"}),(0,t.jsx)("textarea",{value:R,onChange:e=>M(e.target.value),className:"w-full px-3 py-2 border rounded font-mono text-sm",rows:3,placeholder:"Enter symbols for M cells in reading order"}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Length: ",[...R.replace(/[\n\r]/g,"")].length]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Allowed Symbols (A cells)"}),(0,t.jsx)("input",{type:"text",value:I,onChange:e=>O(e.target.value),className:"w-full px-3 py-2 border rounded font-mono text-sm",placeholder:"Enter symbols for A cells"}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Length: ",[...I.replace(/[\n\r]/g,"")].length]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Disallowed Symbols (D cells)"}),(0,t.jsx)("input",{type:"text",value:A,onChange:e=>D(e.target.value),className:"w-full px-3 py-2 border rounded font-mono text-sm",placeholder:"Enter symbols for D cells"}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Length: ",[...A.replace(/[\n\r]/g,"")].length]})]})]}),(0,t.jsxs)("div",{className:"mt-6 p-3 bg-blue-50 rounded text-sm",children:[(0,t.jsx)("p",{className:"font-medium mb-1",children:"How to use:"}),(0,t.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-xs",children:[(0,t.jsx)("li",{children:"Select a brush and paint cells"}),(0,t.jsx)("li",{children:"Enter symbols in reading order (left→right, top→bottom)"}),(0,t.jsx)("li",{children:"Symbol count must match cell count"}),(0,t.jsx)("li",{children:"Add pieces for the initial state"}),(0,t.jsx)("li",{children:"Validate and export"})]})]})]})]}),q&&(0,t.jsx)(b,{onClose:()=>_(!1),onCreatePiece:e=>{V([...B,{...e,id:g()}]),_(!1)},editingPiece:W}),H&&(0,t.jsx)(T,{level:{id:u,name:f,width:w,height:C,grid:E,mainSymbols:R,allowedSymbols:I,disallowedSymbols:A,initialPieces:B},onClose:()=>Y(!1)}),G&&(0,t.jsx)(P,{onClose:()=>F(!1),onLoad:e=>{console.log("Loading level:",e),v(e.id),j(e.name),k(e.width),S(e.height),L(e.grid),M(e.mainSymbols),O(e.allowedSymbols),D(e.disallowedSymbols),V(e.initialPieces),F(!1)}}),Q&&(0,t.jsx)(N,{x:Q.x,y:Q.y,pieceId:Q.pieceId,currentType:Q.currentType,onClose:()=>Z(null),onDelete:()=>{var e;return e=Q.pieceId,void(V(B.filter(t=>t.id!==e)),Z(null))},onDuplicate:()=>{var e;let t;return e=Q.pieceId,void((t=B.find(t=>t.id===e))&&V([...B,{...t,id:g(),position:{x:t.position.x+2,y:t.position.y+2}}]),Z(null))},onChangeType:e=>{var t;return t=Q.pieceId,void(V(B.map(s=>s.id===t?{...s,type:e}:s)),Z(null))},onEditShape:()=>{var e;let t;return e=Q.pieceId,void((t=B.find(t=>t.id===e))&&(J(t),_(!0)),Z(null))}})]})}e.s(["default",()=>R],40104)}]);